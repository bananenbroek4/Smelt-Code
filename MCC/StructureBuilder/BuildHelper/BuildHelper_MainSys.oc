summon minecraft:falling_block ~2 ~5 ~ {Block:redstone_block,Time:1,Passengers:[{id:falling_block,Block:activator_rail,Time:1,Passengers:[{id:commandblock_minecart,Command:"kill @e[tag=oc_marker,r=0]"},{id:commandblock_minecart,Command:"summon minecraft:armor_stand ~1 ~0 ~0 {Tags:[\"oc_rebuild\"]}"},{id:commandblock_minecart,Command:"execute @e[tag=oc_rebuild] ~ ~ ~ fill ~1 ~1 ~1 ~13 ~14 ~1 air 0"},{id:commandblock_minecart,Command:"execute @e[tag=oc_rebuild] ~ ~ ~ kill @e[tag=oc_marker,dx=14,dy=14,dz=2]"},{id:commandblock_minecart,Command:"setblock ~5 ~4 ~1 chain_command_block 5 replace {Command:\"/execute @e[name=Loop_x_expand,type=area_effect_cloud] ~ ~ ~ /blockdata ~ ~ ~ {auto:1b}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~4 ~4 ~1 chain_command_block 5 replace {Command:\"execute @e[name=x_270,tag=x_chooserot] ~ ~ ~ /scoreboard players tag @e[name=Loop_x_expand] add x_270\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~3 ~4 ~1 chain_command_block 5 replace {Command:\"execute @e[name=x_180,tag=x_chooserot] ~ ~ ~ /scoreboard players tag @e[name=Loop_x_expand] add x_180\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~2 ~4 ~1 chain_command_block 5 replace {Command:\"execute @e[name=x_90,tag=x_chooserot] ~ ~ ~ /scoreboard players tag @e[name=Loop_x_expand] add x_90\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~2 ~3 ~1 chain_command_block 1 replace {Command:\"execute @e[name=x_0,tag=x_chooserot] ~ ~ ~ /scoreboard players tag @e[name=Loop_x_expand] add x_0\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~3 ~3 ~1 chain_command_block 4 replace {Command:\"scoreboard players tag @r[type=area_effect_cloud,tag=x_rotation] add x_chooserot\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~4 ~3 ~1 chain_command_block 4 replace {Command:\"scoreboard players tag @e[name=Loop_x_expand] remove x_270\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~5 ~3 ~1 chain_command_block 4 replace {Command:\"scoreboard players tag @e[name=Loop_x_expand] remove x_180\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~6 ~3 ~1 chain_command_block 4 replace {Command:\"scoreboard players tag @e[name=Loop_x_expand] remove x_90\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~7 ~3 ~1 chain_command_block 4 replace {Command:\"scoreboard players tag @e[name=Loop_x_expand] remove x_0\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~8 ~3 ~1 chain_command_block 4 replace {Command:\"summon area_effect_cloud ~ ~ ~ {CustomName:\\\"x_270\\\",Tags:[\\\"x_rotation\\\"],Duration:1}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~9 ~3 ~1 chain_command_block 4 replace {Command:\"summon area_effect_cloud ~ ~ ~ {CustomName:\\\"x_180\\\",Tags:[\\\"x_rotation\\\"],Duration:1}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~10 ~3 ~1 chain_command_block 4 replace {Command:\"summon area_effect_cloud ~ ~ ~ {CustomName:\\\"x_90\\\",Tags:[\\\"x_rotation\\\"],Duration:1}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~11 ~3 ~1 chain_command_block 4 replace {Command:\"summon area_effect_cloud ~ ~ ~ {CustomName:\\\"x_0\\\",Tags:[\\\"x_rotation\\\"],Duration:1}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~12 ~3 ~1 chain_command_block 4 replace {Command:\"scoreboard players set @e[type=area_effect_cloud,tag=x_new] x_z 0\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~13 ~3 ~1 chain_command_block 4 replace {Command:\"scoreboard players set @e[type=area_effect_cloud,tag=x_new] x_x 0\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~14 ~3 ~1 chain_command_block 4 replace {Command:\"/execute @e[name=x_TS] ~ ~ ~ scoreboard objectives add x_zs dummy\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~14 ~2 ~1 chain_command_block 1 replace {Command:\"/execute @e[name=x_TS] ~ ~ ~ scoreboard objectives add x_xs dummy\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~13 ~2 ~1 chain_command_block 5 replace {Command:\"/execute @e[name=x_TS] ~ ~ ~ scoreboard objectives add x_zholder dummy\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~12 ~2 ~1 chain_command_block 5 replace {Command:\"/execute @e[name=x_TS] ~ ~ ~ scoreboard objectives add x_z dummy\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~11 ~2 ~1 chain_command_block 5 replace {Command:\"/execute @e[name=x_TS] ~ ~ ~ scoreboard objectives add x_xholder dummy\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~10 ~2 ~1 chain_command_block 5 replace {Command:\"/execute @e[name=x_TS] ~ ~ ~ scoreboard objectives add x_x dummy\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~9 ~2 ~1 chain_command_block 5 replace {Command:\"execute @e[tag=eventloop+,type=area_effect_cloud] ~ ~ ~ detect ~ ~ ~ air * /kill @e[c=1,r=0,type=area_effect_cloud,tag=eventloop+]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~8 ~2 ~1 chain_command_block 5 replace {Command:\"kill @e[name=x_spawnstructure]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~7 ~2 ~1 chain_command_block 5 replace {Command:\"execute @e[name=x_TS] ~ ~ ~ /execute @e[name=x_spawnstructure] ~ ~ ~ /summon area_effect_cloud ~ ~ ~ {CustomName:\\\"x_SS\\\",Small:1,Marker:1,NoGravity:1,Tags:[\\\"x_new\\\"],Duration:200}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~6 ~2 ~1 chain_command_block 5 replace {Command:\"execute @r[type=armor_stand,name=x_template,tag=x_samematerial] ~ ~ ~ /summon area_effect_cloud ~ ~ ~ {CustomName:\\\"x_TS\\\",Small:1,Marker:1,NoGravity:1,Tags:[\\\"x_new\\\",\\\"x_spwnscan\\\",\\\"x_lastcycle\\\"],Duration:200}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~5 ~2 ~1 chain_command_block 5 replace {Command:\"scoreboard objectives remove x_samematerial\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~4 ~2 ~1 chain_command_block 13 replace {Command:\"execute @e[name=x_spawnstructure] ~ ~ ~ /playsound block.note.bass master @p\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~3 ~2 ~1 chain_command_block 13 replace {Command:\"execute @e[name=x_spawnstructure] ~ ~ ~ /title @p actionbar [{\\\"text\\\":\\\"ERROR - No valid template found: you might be using the wrong filter, or the templates may not be enabled!\\\",\\\"color\\\":\\\"gold\\\"}]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~2 ~2 ~1 chain_command_block 5 replace {Command:\"testforblock ~0 ~-1 ~0 minecraft:chain_command_block -1 {SuccessCount:0}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~2 ~1 ~1 chain_command_block 1 replace {Command:\"testforblock ~1 ~0 ~0 minecraft:chain_command_block -1 {SuccessCount:0}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~3 ~1 ~1 chain_command_block 4 replace {Command:\"/testforblock ~1 ~0 ~0 chain_command_block * {SuccessCount:0}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~4 ~1 ~1 chain_command_block 4 replace {Command:\"testfor @e[name=x_template,tag=x_samematerial]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~5 ~1 ~1 chain_command_block 4 replace {Command:\"execute @e[name=x_template,score_x_samematerial_min=1] ~ ~ ~ detect ~ ~-2 ~ lever powered=true /scoreboard players tag @e[name=x_template,c=1,r=0] add x_samematerial\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~6 ~1 ~1 chain_command_block 4 replace {Command:\"scoreboard players tag @e[name=x_template] remove x_samematerial\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~7 ~1 ~1 chain_command_block 4 replace {Command:\"stats entity @e[name=x_template] clear SuccessCount\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~8 ~1 ~1 chain_command_block 4 replace {Command:\"execute @e[name=x_template] ~ ~-1 ~ /testforblocks ~ ~ ~ ~ ~ ~ <x> 0 <z>\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~9 ~1 ~1 chain_command_block 4 replace {Command:\"stats entity @e[name=x_template,type=armor_stand] set SuccessCount @e[c=1,name=x_template,type=armor_stand] x_samematerial\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~10 ~1 ~1 chain_command_block 4 replace {Command:\"execute @e[name=x_spawnstructure] ~ ~-1 ~ /clone ~ ~ ~ ~ ~ ~ <x> 0 <z>\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~11 ~1 ~1 chain_command_block 4 replace {Command:\"scoreboard players set @e[name=x_template] x_samematerial 0\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~12 ~1 ~1 chain_command_block 4 replace {Command:\"scoreboard objectives add x_samematerial dummy\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~13 ~1 ~1 chain_command_block 4 replace {Command:\"execute @e[name=x_spawnstructure] ~ ~ ~ /fill ~ ~ ~ ~ ~ ~ air 0 replace command_block *\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"summon area_effect_cloud ~14 ~1 ~1 {Duration:2147483647,CustomName:\"Event_x_initiatetransfer\",Tags:[\"SpawnedIn\",\"eventloop+\"]}"},{id:commandblock_minecart,Command:"/kill @e[type=area_effect_cloud,name=Event_x_initiatetransfer,c=1,tag=!SpawnedIn]"},{id:commandblock_minecart,Command:"setblock ~14 ~1 ~1 command_block 4 replace {Command:\"\",TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~14 ~0 ~1 chain_command_block 1 replace {Command:\"kill @e[name=x_spawnstructure,tag=!x_transferstructure]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~13 ~0 ~1 chain_command_block 5 replace {Command:\"kill @e[name=x_template,type=armor_stand,tag=x_onAir]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~12 ~0 ~1 chain_command_block 5 replace {Command:\"execute @e[name=x_template,type=armor_stand] ~ ~ ~ detect ~ ~-1 ~ air * /scoreboard players tag @e[dx=0,name=x_template] add x_onAir\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~11 ~0 ~1 chain_command_block 5 replace {Command:\"scoreboard players tag @e[name=x_template] remove x_onAir\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~10 ~0 ~1 chain_command_block 13 replace {Command:\"scoreboard players tag @e[name=x_spawnstructure,tag=x_transferstructure] add x_transferredstructure\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~9 ~0 ~1 chain_command_block 13 replace {Command:\"/execute @e[name=Event_x_initiatetransfer,type=area_effect_cloud] ~ ~ ~ /blockdata ~ ~ ~ {auto:0b}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~8 ~0 ~1 chain_command_block 13 replace {Command:\"/execute @e[name=Event_x_initiatetransfer,type=area_effect_cloud] ~ ~ ~ /blockdata ~ ~ ~ {auto:1b}\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~7 ~0 ~1 chain_command_block 13 replace {Command:\"testfor @e[name=x_spawnstructure,tag=!x_transferredstructure]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~6 ~0 ~1 chain_command_block 13 replace {Command:\"scoreboard players tag @e[name=x_spawnstructure,type=armor_stand,tag=!x_transferstructure] add x_transferstructure\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~5 ~0 ~1 chain_command_block 13 replace {Command:\"testfor @e[name=x_spawnstructure,type=armor_stand,tag=!x_transferstructure]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~4 ~0 ~1 chain_command_block 5 replace {Command:\"testfor @e[name=x_template,type=armor_stand]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~3 ~0 ~1 chain_command_block 5 replace {Command:\"execute @e[name=x_TS] ~ ~ ~ /kill @e[name=x_spawnstructure]\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~2 ~0 ~1 repeating_command_block 5 replace {Command:\"execute @e[name=x_TS] ~ ~ ~ /execute @e[name=x_spawnstructure] ~ ~ ~ /setblock ~ ~ ~ air\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"setblock ~0 ~1 ~0 command_block 1 replace {Command:\"/fill ~ ~-1 ~ ~ ~ ~ air\",auto:1b,TrackOutput:0b}"},{id:commandblock_minecart,Command:"kill @e[tag=oc_rebuild]"},{id:commandblock_minecart,Command:"kill @e[type=commandblock_minecart,r=0]"}]}]}